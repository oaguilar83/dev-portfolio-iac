# dev-portfolio-iac

Infrastructure as Code (IaC) project for deploying a developer portfolio website on AWS using Terraform and Ansible.

## Overview

This project automates the provisioning and configuration of a portfolio website with:

- **Terraform**: Provisions AWS infrastructure (EC2, Route53)
- **Ansible**: Configures the server (Nginx, TLS certificates)
- **Let's Encrypt**: Automated SSL/TLS via Certbot

## Architecture

```
                    ┌─────────────────┐
                    │    Route53      │
                    │  DNS Zone       │
                    └────────┬────────┘
                             │
                    ┌────────▼────────┐
                    │   EC2 Instance  │
                    │  Ubuntu 24.04   │
                    │  ┌───────────┐  │
                    │  │   Nginx   │  │
                    │  │  + TLS    │  │
                    │  └───────────┘  │
                    └─────────────────┘
```

## Directory Structure

```
dev-portfolio-iac/
├── terraform/                  # Infrastructure provisioning
│   ├── main.tf                # AWS resources (EC2, Route53, Security Group, Key Pair)
│   ├── providers.tf           # AWS provider config
│   ├── variables.tf           # Input variables
│   ├── outputs.tf             # Output values
│   └── terraform.tf           # Version constraints
├── ansible/                    # Configuration management
│   ├── ansible.cfg            # Ansible settings
│   ├── playbooks/
│   │   ├── install_nginx.yml  # Nginx installation playbook
│   │   └── install_tls_cert.yml # TLS certificate playbook
│   ├── inventory/
│   │   └── hosts.ini          # Target hosts
│   └── files/
│       ├── index.html         # Portfolio website
│       ├── nginx.conf.j2      # Nginx config template (HTTP)
│       └── nginx.conf.tls.j2  # Nginx config template (HTTPS)
└── TODO.md                    # Roadmap
```

## Prerequisites

- [Terraform](https://www.terraform.io/downloads) >= 1.2
- [Ansible](https://docs.ansible.com/ansible/latest/installation_guide/index.html)
- AWS CLI configured with appropriate credentials
- A registered domain with nameservers pointed to AWS Route53

## Setup

### 1. Provision Infrastructure with Terraform

```bash
cd terraform

# Initialize Terraform
terraform init

# Review planned changes
terraform plan

# Apply infrastructure
terraform apply
```

### 2. Update Ansible Inventory

After Terraform completes, update `ansible/inventory/hosts.ini` with the EC2 public IP from the Terraform output. The SSH private key is automatically generated at `terraform/dev-portfolio-key.pem`.

### 3. Configure Server with Ansible

```bash
cd ansible

# Set SSH key path (generated by Terraform)
export SSH_PRIVATE_KEY_FILE=../terraform/dev-portfolio-key.pem

# Install Nginx (HTTP)
ansible-playbook -i inventory playbooks/install_nginx.yml

# Install TLS certificate and enable HTTPS
ansible-playbook -i inventory playbooks/install_tls_cert.yml
```

## Configuration

### Terraform Variables

| Variable | Default | Description |
|----------|---------|-------------|
| `aws_region` | `us-east-2` | AWS region |
| `instance_type` | `t2.micro` | EC2 instance type |
| `key_name` | `dev-portfolio-key` | AWS Key Pair name |

### Terraform Outputs

- `instance_id` - EC2 instance ID
- `instance_public_ip` - EC2 public IP address
- `instance_public_dns` - EC2 public DNS name
- `name_servers` - Route53 nameservers for domain
- `private_key_path` - Path to the generated SSH private key
- `ssh_command` - Ready-to-use SSH command to connect to the instance

## What Gets Deployed

1. **EC2 Instance**: Ubuntu 24.04 LTS (t2.micro)
2. **Security Group**: SSH (restricted to deployer IP), HTTP, and HTTPS access
3. **SSH Key Pair**: Auto-generated RSA 4096-bit key pair
4. **Route53 Zone**: DNS management for domain
5. **DNS Records**: A record for root domain, alias for www
6. **Nginx**: Web server with HTTPS enabled
7. **TLS Certificate**: Let's Encrypt certificate via Certbot

## Roadmap

See [TODO.md](TODO.md) for planned improvements including:

- Automate everything with Python

## License

MIT
